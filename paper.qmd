---
title: "The Effects of Mandatory Seat Belt Laws on Driving Behavior and Traffic Fatalities"
author:
  - name: Juan David Rengifo-Castro
    orcid: 0009-0004-5169-4484
    email: jdrengifoc@eafit.com
    affiliations:
      - name: EAFIT
        city: Medellín
  - name: Angel Samuel Suesca Rios
    email: assuescar@eafit.edu.co
    affiliations:
      - name: Banco de la República
        city: Medellín
  - name: Mario Aguirre Posada
    email: maguirrep@eafit.edu.co
    affiliations:
      - name: EAFIT
        city: Medellín
format: 
  html:
    df-print: kable
    code-fold: true
    code-summary: "Show the code"
editor: visual
bibliography: references.bib
---

```{r}
#| warning: false
library(pder)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
library(stargazer)

data("SeatBelt")
```


-   [*Los cuadros y gráficas deben tener titulo y ser enumeradas (por ejemplo, Cuadro 1, Cuadro 2, Gráfico 1, Gráfico 2,...) y llevar la fuente (por ejemplo, Fuente: Cálculos propios a partir del Censo Económico Cali, 2005; Fuente: Censo Económico Cali, 2005; Fuente: GEIH, 2010)*]{style="color:red;"}

# Introduction

[*Se plantea una motivación del tema a trabajar, en particular se menciona por qué es importante el tema y cuál es el objetivo principal del estudio. Se debe mencionar los datos con los se van a trabajar (país o ciudad, período o año, población analizada...). En el último párrafo de la introducción se debe mencionar la estructura del documento, esto es, las secciones que componen el documento.*]{style="color:red;"}

# Literature Review

[*Revisión de literatura: se debe hacer una revisión de literatura y en último párrafo mencionar cuál es el principal aporte del documento respecto a la literatura existente.*]{style="color:red;"}

**Provided literature:**

-   [@cohen2003]

-   [@stock2020introduction Exercise 10.2]

# Data and Empirical Evidence

[*Se mencionan los datos utilizados con más detalle y se describen las estadísticas descriptivas de las variables más importantes a analizar*]{style="color:red;"}

[*Se debe mencionar los datos con los se van a trabajar (país o ciudad, período o año, población analizada...)*]{style="color:red;"}

As mentioned before, the data employed for this paper was originally gather by @cohen2003 from a variety of official US authorities. The dataset can be download directly from [Leinav's website](https://leinav.people.stanford.edu/research), or from the `R` library `pder` of panel data econometrics developed by @pder. The panel includes data of 50 U.S. states plus the District of Columbia (also known as Washington D.C.) from 1983 to 1997 in a yearly basis. The main variables are the *average seat belt usage rate* (SBUR) and the *traffic fatalities of vehicle occupants* and *non-occupants*, for short, TFVO and TFVN accordingly. The SBUR is reported by the *Highway Safety Office of each state*, which for most states is disaggregated by front and rear seats. However, as some states only have the value for front seat occupants, we exclude for the analysis the rear seats values. This data is collected by the states in a longitudinal survey following the *National Highway Traffic Safety Administration* (NHTSA) guidelines, however, a potential issue is that states may choose to overstate their usage in order to receive federal budgets by meeting certain thresholds. To overcome this concern, @cohen2003 elaborated robustness checks with the aid of telephone self-reported surveys conducted by the Center for Disease Control (CDC).

By its part, the number of fatalities was obtained from the *Fatalities Analysis Reporting System* (FARS). They divide the fatalities by occupants and non-occupants (pedestrians and byciclists). A limitation of this data to our design is that in some states, the compulsory laws of seat bealt usage is only for front seats, then one could argue that in those states, rear passengers should be consider as non-occupants. Potentially this could bias upward our estimates for TFVO. For the TFVN's estimates, the direction and presence of the bias is unknown as may be opposite effects through different mechanisms.




The @fig-data-fatalities_usage presents the evolution of these variables in the period of analysis, where the black line refers to the SBUR, which increases over time as expected.

Is worth noting that the TFVO and TFVN can adopt different forms, for instance, one could take the raw number of fatalities. Nevertheless, as shown by the @fig-data-fatalities_usage in the dashed lines, this measure does not exhibit a decreasing trend across years, as the vehicle population also increased. One solution is to normalize by vehicle miles traveled (VMT).[^1] The green and purples solid lines of @fig-data-fatalities_usage present the normalized fatalities, where clearly, the TFVO and TFVN decrease with time. In summary, the SBUR has a negative correlation with the TFVO and TFVN, however, we cannot conclude causality as it may be spurious by confounding variables such as national road safety campaigns and road infrastructure conditions. Besides, the variable

[^1]: henceforth, the TFVO and TFVN will refer to the normalized values.




```{r}
#| label: fig-data-fatalities_usage
#| fig-cap: "Deaths due to vehicular accidents and the SBUR."
#| fig-width: 10
#| fig-height: 6
processed_data <- SeatBelt %>% 
  mutate(vmt = vmtrural + vmturban,
         farsocc_norm = farsocc / vmt,
         farsnocc_norm = farsnocc / vmt) %>%
  select(year, farsocc, farsnocc, farsocc_norm, farsnocc_norm) %>% 
  pivot_longer(cols = starts_with('fars'), 
               names_to = 'category', values_to = 'fatalities') %>% 
  group_by(year, category) %>% 
  summarise(fatalities = sum(fatalities), .groups = 'drop') %>% 
  mutate(
    type = if_else(str_detect(category, "_norm"), "Normalized", "Raw"),
    category = str_replace(category, '_norm', '')) %>% 
  bind_rows(
    SeatBelt %>% 
      select(year, usage) %>% 
      group_by(year) %>% 
      summarise(usage = mean(usage, na.rm = T)) %>% 
      mutate(type = 'usage', category = 'usage') %>% rename(fatalities = usage)
  )

# Calculamos los factores de escala fuera de ggplot
max_raw <- max(processed_data$fatalities[processed_data$type == "Raw"])
max_normalized <- max(processed_data$fatalities[processed_data$type == "Normalized"])
scale_factor <- max_raw / max_normalized

# Creamos el gráfico
ggplot(processed_data, aes(x = year, y = fatalities, color = category, linetype = type)) +
  geom_line(data = ~ filter(., type == "usage"), linetype = 'solid') +
  geom_line(data = ~ filter(., type == "Normalized")) +
  geom_line(data = ~ filter(., type == "Raw"), aes(y = fatalities / scale_factor)) +
  scale_x_continuous(breaks = seq(1983, 1998, by = 1)) +
  scale_y_continuous(
    breaks = seq(0, 1.25, by = 0.25), limits = c(0, 1.25),
    name = "Fatalities per VMT / SBUR",
    sec.axis = sec_axis(
      ~ . * scale_factor, name = "Number of fatalities",
      breaks = seq(0, 45e3, by = 5e3)
    )
  ) +
  labs(x = "Year") +
  theme_minimal(14) +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  ) +
  scale_color_manual(values = c("farsocc" = "#47D134", "farsnocc" = "#922FD6", 'usage' = 'black'),
                     labels = c("Non-occupant", "Occupant", "SBUR")) +
  guides(
    color = guide_legend(nrow = 2, byrow = TRUE),    # Agrupa en dos filas
    linetype = guide_legend(nrow = 2, byrow = TRUE)  # Agrupa en dos filas
  )
```

-   @fig-data-fatalities_usage 1. tres mapas en diferentes momentos en el tiempo (si hay suficiente cambio, si no hay tanto, poner solo

```{r}
library(pder)
data("SeatBelt")
head(SeatBelt)
```


# Econometric Model

[*plantear la ecuación del modelo a estimar y describir éste modelo: variable dependiente, independientes y error*]{style="color:red;"}

# Results

[*Descripción de los de resultados, deduciendo implicaciones*]{style="color:red;"}

# Conclussions

[*descripción de los principales resultados encontrados, implicaciones y discusión (implicaciones de política...)*]{style="color:red;"}
